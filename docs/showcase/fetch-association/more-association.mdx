---
sidebar_position: 2
title: 2.2 跟多关联
---

## 查询动态实体

<Tabs groupId="language">
<TabItem value="java" label="Java">

```java
BookTable table = BookTable.$;

List<Book> books = sqlClient
    .createQuery(table)
    .where(table.name().eq("Learning GraphQL"))
    .orderBy(table.edition().desc())
    .select(
        table.fetch(
            BookFetcher.$
                .allScalarFields()
                .store( ❶
                    BookStoreFetcher.$
                        .allScalarFields()
                )
                .authors( ❷
                    AuthorFetcher.$
                        .allScalarFields()
                )
        )
    )
    .execute();
```

</TabItem>
<TabItem value="kotlin" label="Kotlin">

```kotlin
val books = sqlClient
    .createQuery(Book::class) {
        where(table.name  eq "Learning GraphQL")
        orderBy(table.edition.desc())
        select(
            table.fetchBy {
                allScalarFields()
                store { ❶
                    allScalarFields()
                }
                authors { ❷
                    allScalarFields()
                }
            }
        )
    }
    .execute()
```

</TabItem>
</Tabs>

得到的结果为

```json
[
    {
        "id":3,
        "name":"Learning GraphQL",
        "edition":3,
        "price":51,
        "store":{ ❶
            "id":1,
            "name":"O'REILLY",
            "website":null
        },
        "authors":[ ❷
            {
                "id":2,
                "firstName":"Alex",
                "lastName":"Banks",
                "gender":"MALE"
            },
            {
                "id":1,
                "firstName":"Eve",
                "lastName":"Procello",
                "gender":"FEMALE"
            }
        ]
    },
    {
        "id":2,
        "name":"Learning GraphQL",
        "edition":2,
        "price":55,
        "store":{ ❶
            "id":1,
            "name":"O'REILLY",
            "website":null
        },
        "authors":[ ❷
            {
                "id":2,
                "firstName":"Alex",
                "lastName":"Banks",
                "gender":"MALE"
            },
            {
                "id":1,
                "firstName":"Eve",
                "lastName":"Procello",
                "gender":"FEMALE"
            }
        ]
    },
    {
        "id":1,
        "name":"Learning GraphQL",
        "edition":1,
        "price":50,
        "store":{ ❶
            "id":1,
            "name":"O'REILLY",
            "website":null
        },
        "authors":[ ❷
            {
                "id":2,
                "firstName":"Alex",
                "lastName":"Banks",
                "gender":"MALE"
            },
            {
                "id":1,
                "firstName":"Eve",
                "lastName":"Procello",
                "gender":"FEMALE"
            }
        ]
    }
]
```